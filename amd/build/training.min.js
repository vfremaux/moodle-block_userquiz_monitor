define(["jquery","core/config","core/log"],function(a,b,c){var d,e,f,g,h,i={init:function(b,i,j,k,l){d=b,e=i,h=j,f=k,g=l,a(".cb-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a("#checkall-master").prop("checked",!1),a("#checkall-master").bind("change",this.select_all_master_categories),a(".cb-master").bind("click",this.update_selector_master_global),a(".userquiz-monitor-cat-button").bind("click",this.fetch_training_subcategories),a(".userquiz-monitor-cat-button").addClass("active"),a(".userquiz-monitor-exam-cat-button").bind("click",this.fetch_exam_subcategories),a(".userquiz-monitor-exam-cat-button").addClass("active"),c.debug("AMD Block_userquiz_monitor quizforceanswer initialized")},init_detail:function(){var b=a(this);regexp=/[^0-9]*([0-9]+)$/,matches=b.attr("id").match(regexp),categoryid=matches[1],a("#id-checkall-detail-"+categoryid).prop("checked",!1),a("#id-checkall-detail-"+categoryid).bind("change",this.select_all_detail_categories),a(".cb-detail-"+categoryid).prop("checked",!1),a(".cb-detail-"+categoryid).bind("click",this.update_selector_detail),c.debug("AMD Block_userquiz_monitor detail "+categoryid+" initialized")},update_selector_master_ajax:function(){var b=a(this),c=parseInt(b.attr("id").replace("id-cb-master-",""));c||(c=parseInt(b.attr("id").replace("details-button-","")));var e="courseid="+d+"&rootcategory="+h+"&categoryid="+c;e+="&location=mode0&quizlist="+f;var g=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+e;b.prop("checked")&&a(".cb-detail-"+c).prop("checked",!0),a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_master_global:function(b){var c="";"all"===b&&this.select_all_master_cb(),a(".cb-master").each(function(b){if(a(this).prop("checked")){var d=a(this).attr("id").replace("id-cb-master-","");c=""===c?d:c+","+d}}),""===c&&(c="null");var e="courseid="+d+"&rootcategory="+h+"&categoryid="+c;e+="&location=mode0&quizlist="+f;var g=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+e;a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_detail:function(){c.debug("update_selector_detail");var e="",g=!0,i=0,j=this.className.split(" ");for(var k in j)j[k].match(/^cb-detail-/)&&(i=j[k].replace("cb-detail-",""));a(".cb-detail").each(function(b){var c=a(this),d=c.attr("id").replace("id-cb-detail-",""),f=!0;a(this).prop("checked")?e=""===e?d:e+","+d:f=!1}),!g&&i&&a("#id-cb-master-"+i).prop("checked",!1),""===e&&(e="null");var l="courseid="+d+"&rootcategory="+h+"&categoryid="+e;l+="&location=mode1&quizlist="+f;var m=b.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+l;a.get(m,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},refresh_selector:function(){var c=a(this),d=c.attr("id").replace(),e="rootcategory="+h+"&categoryid="+d+"&quizzeslist="+f,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/refreshselector.php?"+e;a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},select_all_master_categories:function(){a("#checkall-master").prop("checked")?a(".cb-master").prop("checked",!0):a(".cb-master").prop("checked",!1),i.update_selector_master_global()},select_all_detail_categories:function(){var b=a(this),c=b.attr("id").replace("id-checkall-detail-","");b.prop("checked")?a(".cb-detail-"+c).prop("checked",!0):a(".cb-detail-"+c).prop("checked",!1);var d=a.proxy(i.update_selector_detail,this);d()},reset_training:function(c){var e="id="+d+"&userid="+c+"&quizzeslist="+f,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/resettraining.php?"+e;a.get(g,function(a,c){alert(a),window.location=b.wwwroot+"/course/view.php?id="+d},"html")},refresh_content:function(){var c=a(this),e=c.attr("id").replace("",""),f="courseid="+d+"&rootcategory="+h+"&id="+e,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/schedulecontent.php?"+f;a.get(g,function(b){a("#divschedule").html(b),this.highlight_amf_cat(e)})},highlight_training_cat:function(b){a("trainingcat").removeClass("active"),a("trainingcat").addClass("inactive");for(var c=0;12>c;c++)c===b&&(a("#trainingcat"+c).removeClass("inactive"),a("#trainingcat"+c).addClass("active"))},close_detail:function(){var b=a(this),c=b.attr("id").replace("id-cancel-detail-","");a("#checkall-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a(".cb-master").prop("disabled",!1),a(".cb-master").addClass("trans100"),a(".cb-master").removeClass("trans50"),a("#id-detail-button-div-"+c).addClass("active"),a(".progressbar-container").css("visibility","visible"),a(".category-subpod").css("display","none"),a("#category-subcatpod-"+c).html(""),a(".cb-master").prop("disabled",!1),a(".div-main").removeClass("trans50"),a(".div-main").addClass("trans100");var d=a.proxy(i.update_selector_detail,this);d()},fetch_training_subcategories:function(g){var j=a(this),k=j.attr("id").replace("details-button-div-",""),l="blockid="+e+"&courseid="+d+"&rootcategory="+h;l+="&categoryid="+k+"&quizzeslist="+f+"&mode=training";var m=b.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+l;a.post(m,"",function(b){var d;d=isNaN(k)?k.replace("details-button-",""):k,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+k).html(""),a("#category-subcatpod-"+d).html(b),a("#category-subcatpod-"+d).css("display","inline-block"),c.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-checkall-detail-"+k).prop("checked",!1),a("#id-checkall-detail-"+k).bind("change",i.select_all_detail_categories),a("#id-cb-master-"+k).prop("checked")?(a("#id-checkall-detail-"+k).prop("checked",!0),a(".cb-detail-"+k).prop("checked",!0)):(a("#id-checkall-detail-"+k).prop("checked",!1),a(".cb-detail-"+k).prop("checked",!1)),a(".cb-detail-"+k).bind("click",i.update_selector_detail),a("#id-cancel-detail-"+k).bind("click",i.close_detail),a("#id-detail-button-div-"+k).removeClass("active"),a(".cb-master").prop("disabled",!0),a(".cb-master").prop("checked",!1),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#cb-master-"+k).prop("disabled",!1),a("#id-div-main-"+k).removeClass("trans50"),a("#id-div-main-"+k).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+k).offset().top},"slow");var e=a.proxy(i.update_selector_detail,this);e()},"html")},fetch_exam_subcategories:function(f){var j=a(this),k=j.attr("id").replace("details-button-div-",""),l="blockid="+e+"&courseid="+d+"&rootcategory="+h;l+="&categoryid="+k+"&quizzeslist="+g+"&mode=exam";var m=b.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+l;a.post(m,"",function(b){var d;d=isNaN(k)?k.replace("details-button-",""):k,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+k).html(""),a("#category-subcatpod-"+d).html(b),a("#category-subcatpod-"+d).css("display","inline-block"),c.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-cancel-detail-"+k).bind("click",i.close_detail),a("#id-detail-button-div-"+k).removeClass("active"),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#id-div-main-"+k).removeClass("trans50"),a("#id-div-main-"+k).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+k).offset().top},"slow")},"html")}};return i});