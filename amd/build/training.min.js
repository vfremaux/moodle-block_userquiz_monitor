define(["jquery","core/log"],function(a,b){var c,d,e,f,g,h={init:function(h,i,j,k,l){c=h,d=i,g=j,e=k,f=l,a(".cb-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a("#checkall-master").prop("checked",!1),a("#checkall-master").bind("change",this.select_all_master_categories),a(".cb-master").bind("click",this.update_selector_master_global),a(".userquiz-monitor-cat-button").bind("click",this.fetch_training_subcategories),a(".userquiz-monitor-cat-button").addClass("active"),a(".userquiz-monitor-exam-cat-button").bind("click",this.fetch_exam_subcategories),a(".userquiz-monitor-exam-cat-button").addClass("active"),b.debug("AMD Block_userquiz_monitor quizforceanswer initialized")},init_detail:function(){that=a(this),regexp=/[^0-9]*([0-9]+)$/,matches=that.attr("id").match(regexp),categoryid=matches[1],a("#id-checkall-detail-"+categoryid).prop("checked",!1),a("#id-checkall-detail-"+categoryid).bind("change",this.select_all_detail_categories),a(".cb-detail-"+categoryid).prop("checked",!1),a(".cb-detail-"+categoryid).bind("click",this.update_selector_detail),b.debug("AMD Block_userquiz_monitor detail "+categoryid+" initialized")},update_selector_master_ajax:function(){var b=a(this);categoryid=parseInt(b.attr("id").replace("id-cb-master-","")),categoryid||(categoryid=parseInt(b.attr("id").replace("details-button-","")));var d="courseid="+c+"&rootcategory="+g+"&categoryid="+categoryid;d+="&location=mode0&quizlist="+e;var f=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+d;b.prop("checked")&&a(".cb-detail-"+categoryid).prop("checked",!0),a.get(f,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_master_global:function(b){var d="";"all"===b&&this.select_all_master_cb(),a(".cb-master").each(function(b){a(this).prop("checked")&&(catid=a(this).attr("id").replace("id-cb-master-",""),d=""===d?catid:d+","+catid)}),""===d&&(d="null");var f="courseid="+c+"&rootcategory="+g+"&categoryid="+d;f+="&location=mode0&quizlist="+e;var h=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+f;a.get(h,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_detail:function(){b.debug("update_selector_detail");var d="",f=!0,h=this.className.split(" ");for(var i in h)if(h[i].match(/^cb-detail-/))var j=h[i].replace("cb-detail-","");a(".cb-detail").each(function(b){var c=a(this);categoryid=c.attr("id").replace("id-cb-detail-",""),a(this).prop("checked")?d=""===d?categoryid:d+","+categoryid:f=!1}),f||a("#id-cb-master-"+j).prop("checked",!1),""===d&&(d="null");var k="courseid="+c+"&rootcategory="+g+"&categoryid="+d;k+="&location=mode1&quizlist="+e;var l=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+k;a.get(l,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},refresh_selector:function(){var b=a(this);categoryid=b.attr("id").replace();var c="rootcategory="+g+"&categoryid="+categoryid+"&quizzeslist="+e,d=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/refreshselector.php?"+c;a.get(d,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},select_all_master_categories:function(){a("#checkall-master").prop("checked")?a(".cb-master").prop("checked",!0):a(".cb-master").prop("checked",!1),h.update_selector_master_global()},select_all_detail_categories:function(){that=a(this),categoryid=that.attr("id").replace("id-checkall-detail-",""),that.prop("checked")?a(".cb-detail-"+categoryid).prop("checked",!0):a(".cb-detail-"+categoryid).prop("checked",!1),callback=a.proxy(h.update_selector_detail,this),callback()},reset_training:function(b){var d="id="+c+"&userid="+b+"&quizzeslist="+e,f=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/resettraining.php?"+d;a.get(f,function(a,b){alert(a),window.location=M.cfg.wwwroot+"/course/view.php?id="+c},"html")},refresh_content:function(){that=a(this),categoryid=that.attr("id").replace("","");var b="courseid="+c+"&rootcategory="+g+"&id="+categoryid,d=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/schedulecontent.php?"+b;a.get(d,function(b){a("#divschedule").html(b),this.highlight_amf_cat(categoryid)})},highlight_training_cat:function(b){for(a("trainingcat").removeClass("active"),a("trainingcat").addClass("inactive"),i=0;i<12;i++)i===b&&(a("#trainingcat"+i).removeClass("inactive"),a("#trainingcat"+i).addClass("active"))},close_detail:function(){that=a(this),categoryid=that.attr("id").replace("id-cancel-detail-",""),a("#checkall-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a(".cb-master").prop("disabled",!1),a(".cb-master").addClass("trans100"),a(".cb-master").removeClass("trans50"),a("#id-detail-button-div-"+categoryid).addClass("active"),a(".progressbar-container").css("visibility","visible"),a(".category-subpod").css("display","none"),a("#category-subcatpod-"+categoryid).html(""),a(".cb-master").prop("disabled",!1),a(".div-main").removeClass("trans50"),a(".div-main").addClass("trans100"),callback=a.proxy(h.update_selector_detail,this),callback()},fetch_training_subcategories:function(f){that=a(this),categoryid=that.attr("id").replace("details-button-div-","");var i="blockid="+d+"&courseid="+c+"&rootcategory="+g;i+="&categoryid="+categoryid+"&quizzeslist="+e+"&mode=training";var j=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+i;a.post(j,"",function(c){var d;d=isNaN(categoryid)?categoryid.replace("details-button-",""):categoryid,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+categoryid).html(""),a("#category-subcatpod-"+d).html(c),a("#category-subcatpod-"+d).css("display","inline-block"),b.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-checkall-detail-"+categoryid).prop("checked",!1),a("#id-checkall-detail-"+categoryid).bind("change",h.select_all_detail_categories),a("#id-cb-master-"+categoryid).prop("checked")?(a("#id-checkall-detail-"+categoryid).prop("checked",!0),a(".cb-detail-"+categoryid).prop("checked",!0)):(a("#id-checkall-detail-"+categoryid).prop("checked",!1),a(".cb-detail-"+categoryid).prop("checked",!1)),a(".cb-detail-"+categoryid).bind("click",h.update_selector_detail),a("#id-cancel-detail-"+categoryid).bind("click",h.close_detail),a("#id-detail-button-div-"+categoryid).removeClass("active"),a(".cb-master").prop("disabled",!0),a(".cb-master").prop("checked",!1),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#cb-master-"+categoryid).prop("disabled",!1),a("#id-div-main-"+categoryid).removeClass("trans50"),a("#id-div-main-"+categoryid).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+categoryid).offset().top},"slow"),callback=a.proxy(h.update_selector_detail,this),callback()},"html")},fetch_exam_subcategories:function(e){that=a(this),categoryid=that.attr("id").replace("details-button-div-","");var i="blockid="+d+"&courseid="+c+"&rootcategory="+g;i+="&categoryid="+categoryid+"&quizzeslist="+f+"&mode=exam";var j=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+i;a.post(j,"",function(c){var d;d=isNaN(categoryid)?categoryid.replace("details-button-",""):categoryid,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+categoryid).html(""),a("#category-subcatpod-"+d).html(c),a("#category-subcatpod-"+d).css("display","inline-block"),b.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-cancel-detail-"+categoryid).bind("click",h.close_detail),a("#id-detail-button-div-"+categoryid).removeClass("active"),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#id-div-main-"+categoryid).removeClass("trans50"),a("#id-div-main-"+categoryid).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+categoryid).offset().top},"slow")},"html")}};return h});