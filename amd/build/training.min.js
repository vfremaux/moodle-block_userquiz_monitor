define(["jquery","core/config","core/log"],function(a,b,c){var d,e,f,g,h,i={init:function(b,i,j,k,l){d=b,e=i,h=j,f=k,g=l,a(".cb-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a("#checkall-master").prop("checked",!1),a("#checkall-master").bind("change",this.select_all_master_categories),a(".cb-master").bind("click",this.update_selector_master_global),a(".userquiz-monitor-cat-button").bind("click",this.fetch_training_subcategories),a(".userquiz-monitor-cat-button").addClass("active"),a(".userquiz-monitor-exam-cat-button").bind("click",this.fetch_exam_subcategories),a(".userquiz-monitor-exam-cat-button").addClass("active"),c.debug("AMD Block_userquiz_monitor quizforceanswer initialized")},init_detail:function(){var b=a(this),d=/[^0-9]*([0-9]+)$/,e=b.attr("id").match(d),f=e[1];a("#id-checkall-detail-"+f).prop("checked",!1),a("#id-checkall-detail-"+f).bind("change",this.select_all_detail_categories),a(".cb-detail-"+f).prop("checked",!1),a(".cb-detail-"+f).bind("click",this.update_selector_detail),c.debug("AMD Block_userquiz_monitor detail "+f+" initialized")},update_selector_master_ajax:function(){var b=a(this),c=parseInt(b.attr("id").replace("id-cb-master-",""));c||(c=parseInt(b.attr("id").replace("details-button-","")));var e="courseid="+d+"&rootcategory="+h+"&categoryid="+c;e+="&location=mode0&quizlist="+f;var g=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+e;b.prop("checked")&&a(".cb-detail-"+c).prop("checked",!0),a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_master_global:function(b){var c="";"all"===b&&this.select_all_master_cb(),a(".cb-master").each(function(){if(a(this).prop("checked")){var b=a(this).attr("id").replace("id-cb-master-","");c=""===c?b:c+","+b}}),""===c&&(c="null");var e="courseid="+d+"&rootcategory="+h+"&categoryid="+c;e+="&location=mode0&quizlist="+f;var g=M.cfg.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+e;a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},update_selector_detail:function(){c.debug("update_selector_detail");var e="",g=!0,i=0,j=this.className.split(" ");for(var k in j)j[k].match(/^cb-detail-/)&&(i=j[k].replace("cb-detail-",""));a(".cb-detail").each(function(){var b=a(this),c=b.attr("id").replace("id-cb-detail-","");a(this).prop("checked")?e=""===e?c:e+","+c:g=!1}),!g&&i&&a("#id-cb-master-"+i).prop("checked",!1),""===e&&(e="null");var l="courseid="+d+"&rootcategory="+h+"&categoryid="+e;l+="&location=mode1&quizlist="+f;var m=b.wwwroot+"/blocks/userquiz_monitor/ajax/updateselector.php?"+l;a.get(m,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},refresh_selector:function(){var c=a(this),d=c.attr("id").replace(),e="rootcategory="+h+"&categoryid="+d+"&quizzeslist="+f,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/refreshselector.php?"+e;a.get(g,function(b){a(".selectorcontainers").html(b),a("#id-selector-nb-questions").length?a("#id-training-go-button").prop("disabled",!1):a("#id-training-go-button").prop("disabled",!0)},"html")},select_all_master_categories:function(){a("#checkall-master").prop("checked")?a(".cb-master").prop("checked",!0):a(".cb-master").prop("checked",!1),i.update_selector_master_global()},select_all_detail_categories:function(){var b=a(this),c=b.attr("id").replace("id-checkall-detail-","");b.prop("checked")?a(".cb-detail-"+c).prop("checked",!0):a(".cb-detail-"+c).prop("checked",!1);var d=a.proxy(i.update_selector_detail,this);d()},reset_training:function(c){var e="id="+d+"&userid="+c+"&quizzeslist="+f,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/resettraining.php?"+e;a.get(g,function(a){alert(a),window.location=b.wwwroot+"/course/view.php?id="+d},"html")},refresh_content:function(){var c=a(this),e=c.attr("id").replace("",""),f="courseid="+d+"&rootcategory="+h+"&id="+e,g=b.wwwroot+"/blocks/userquiz_monitor/ajax/schedulecontent.php?"+f;a.get(g,function(b){a("#divschedule").html(b),this.highlight_amf_cat(e)})},highlight_training_cat:function(b){a("trainingcat").removeClass("active"),a("trainingcat").addClass("inactive");for(var c=0;c<12;c++)c===b&&(a("#trainingcat"+c).removeClass("inactive"),a("#trainingcat"+c).addClass("active"))},close_detail:function(){var b=a(this),c=b.attr("id").replace("id-cancel-detail-","");a("#checkall-master").prop("checked",!1),a("#checkall-master").prop("disabled",!1),a(".cb-master").prop("checked",!1),a(".cb-master").prop("disabled",!1),a(".cb-master").addClass("trans100"),a(".cb-master").removeClass("trans50"),a("#id-detail-button-div-"+c).addClass("active"),a(".progressbar-container").css("visibility","visible"),a(".category-subpod").css("display","none"),a("#category-subcatpod-"+c).html(""),a(".cb-master").prop("disabled",!1),a(".div-main").removeClass("trans50"),a(".div-main").addClass("trans100");var d=a.proxy(i.update_selector_detail,this);d()},fetch_training_subcategories:function(){var g=a(this),j=g.attr("id").replace("details-button-div-",""),k="blockid="+e+"&courseid="+d+"&rootcategory="+h;k+="&categoryid="+j+"&quizzeslist="+f+"&mode=training";var l=b.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+k;a.post(l,"",function(b){var d;d=isNaN(j)?j.replace("details-button-",""):j,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+j).html(""),a("#category-subcatpod-"+d).html(b),a("#category-subcatpod-"+d).css("display","inline-block"),c.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-checkall-detail-"+j).prop("checked",!1),a("#id-checkall-detail-"+j).bind("change",i.select_all_detail_categories),a("#id-cb-master-"+j).prop("checked")?(a("#id-checkall-detail-"+j).prop("checked",!0),a(".cb-detail-"+j).prop("checked",!0)):(a("#id-checkall-detail-"+j).prop("checked",!1),a(".cb-detail-"+j).prop("checked",!1)),a(".cb-detail-"+j).bind("click",i.update_selector_detail),a("#id-cancel-detail-"+j).bind("click",i.close_detail),a("#id-detail-button-div-"+j).removeClass("active"),a(".cb-master").prop("disabled",!0),a(".cb-master").prop("checked",!1),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#cb-master-"+j).prop("disabled",!1),a("#id-div-main-"+j).removeClass("trans50"),a("#id-div-main-"+j).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+j).offset().top},"slow");var e=a.proxy(i.update_selector_detail,this);e()},"html")},fetch_exam_subcategories:function(){var f=a(this),j=f.attr("id").replace("details-button-div-",""),k="blockid="+e+"&courseid="+d+"&rootcategory="+h;k+="&categoryid="+j+"&quizzeslist="+g+"&mode=exam";var l=b.wwwroot+"/blocks/userquiz_monitor/ajax/subcategoriescontent.php?"+k;a.post(l,"",function(b){var d;d=isNaN(j)?j.replace("details-button-",""):j,a(".category-subpod").css("display","none"),a("#category-subcatpod-"+j).html(""),a("#category-subcatpod-"+d).html(b),a("#category-subcatpod-"+d).css("display","inline-block"),c.debug("AMD Block_userquiz_monitor detail "+d+" loaded"),a("#id-cancel-detail-"+j).bind("click",i.close_detail),a("#id-detail-button-div-"+j).removeClass("active"),a(".div-main").addClass("trans50"),a(".div-main").removeClass("trans100"),a("#id-div-main-"+j).removeClass("trans50"),a("#id-div-main-"+j).addClass("trans100"),a("html,body").animate({scrollTop:a("#id-cat-"+j).offset().top},"slow")},"html")}};return i});